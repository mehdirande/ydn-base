<h1 class="classTitle">Class ydn.db.core.Storage</h1>
Provide CRUD database operations.
<p>
Extends <a
    href="https://sites.google.com/a/yathit.com/ydn-dev/api-reference/ydn-db-core">ydn.db.con.Storage</a>
</p>
<table cellspacing="0" class="summaryTable">

  <caption>
    Class Summary
  </caption>

  <thead>

  <tr>
    <th>Constructor Attributes</th>
    <th>Constructor Name and Description</th>
  </tr>
  </thead>
  <tbody>

  <tr>
    <td class="attributes">&nbsp;</td>
    <td class="nameDescription">
      <div class="fixedFont">
        <b><a href="#constructor">ydn.db.core.Storage</a></b>(name, schema, option)
      </div>
      <div class="description">
        Create a suitable storage mechanism. <br/>
        See <a
          href="https://sites.google.com/a/yathit.com/ydn-dev/api-reference/ydn-db-con">ydn.db.con.Storage</a>.
      </div>
    </td>
  </tr>
  </tbody>
</table>


<table cellspacing="0" class="summaryTable">


<caption>
  Method Summary
</caption>

<thead>

<tr>
  <th>Method Attributes</th>
  <th>Method Name and Description</th>
</tr>
</thead>

<tbody>
<tr>
  <td class="attributes">&nbsp;</td>
  <td class="nameDescription">
    <div class="fixedFont">
      <b><a href="#clear">clear</a></b>(store_name, id)
    </div>
    <div class="description">
      Clear an entry from an object store.
    </div>
    <div class="fixedFont">
      <b><a href="#clear1">clear</a></b>(store_name, ids)
    </div>
    <div class="description">
      Clear entries from an object store.
    </div>
    <div class="fixedFont">
      <b><a href="#clear2">clear</a></b>(key)
    </div>
    <div class="description">
      Clear an entry of given key.
    </div>
    <div class="fixedFont">
      <b><a href="#clear3">clear</a></b>(keys)
    </div>
    <div class="description">
      Clear entries of given key list.
    </div>
    <div class="fixedFont">
      <b><a href="#clear4">clear</a></b>(store_name)
    </div>
    <div class="description">
      Clear all entries in an object store.
    </div>
    <div class="fixedFont">
      <b><a href="#clear5">clear</a></b>()
    </div>
    <div class="description">
      Clear all entries in the database.
    </div>

  </td>
</tr>

<tr>

  <td class="attributes">&nbsp;</td>

  <td class="nameDescription">

    <div class="fixedFont">
      <b><a href="#count">count</a></b>(store_name)
    </div>
    <div class="description">
      Get number of items in a store.
    </div>
    <div class="fixedFont">
      <b><a href="#count">count</a></b>()
    </div>
    <div class="description">
      Get number of items form all stores.
    </div>
  </td>
</tr>

<tr>
  <td class="attributes">&nbsp;</td>
  <td class="nameDescription">
    <div class="fixedFont">
      <b><a href="#get">get</a></b>(store_name, id)
    </div>
    <div class="description">
      Retrieve an object.
    </div>
    <div class="fixedFont">
      <b><a href="#get1">get</a></b>(store_name, ids)
    </div>
    <div class="description">
      Retrieve objects from a store.
    </div>
    <div class="fixedFont">
      <b><a href="#get2">get</a></b>(store_name)
    </div>
    <div class="description">
      Retrieve all objects from a store.
    </div>
    <div class="fixedFont">
      <b><a href="#get3">get</a></b>(key)
    </div>
    <div class="description">
      Retrieve an object of given db key.
    </div>
    <div class="fixedFont">
      <b><a href="#get4">get</a></b>(keys)
    </div>
    <div class="description">
      Retrieve objects of given a list of db keys.
    </div>
    <div class="fixedFont">
      <b><a href="#get5">get</a></b>()
    </div>
    <div class="description">
      Retrieve all objects from the database.
    </div>
  </td>
</tr>


<tr>

  <td class="attributes">&nbsp;</td>

  <td class="nameDescription">

    <div class="fixedFont">
      <b><a href="#put">put</a></b>(store_name, value)
    </div>
    <div class="description">
      Put an object.
    </div>
    <div class="fixedFont">
      <b><a href="#put1">put</a></b>(key, value)
    </div>
    <div class="description">
      Put an object with an given db key.
    </div>
    <div class="fixedFont">
      <b><a href="#put2">put</a></b>(store_name, value, id)
    </div>
    <div class="description">
      Put an object with a given key.
    </div>
    <div class="fixedFont">
      <b><a href="#put3">put</a></b>(store_name, values)
    </div>
    <div class="description">
      Put objects to a store.
    </div>
    <div class="fixedFont">
      <b><a href="#put4">put</a></b>(keys, values)
    </div>
    <div class="description">
      Put objects to a store with given db keys.
    </div>
    <div class="fixedFont">
      <b><a href="#put5">put</a></b>(store_name, values, ids)
    </div>
    <div class="description">
      Put objects to a store with given keys.
    </div>
  </td>
</tr>


<tr>
  <td class="attributes">&nbsp;</td>

  <td class="nameDescription">

    <div class="fixedFont">
      <b><a href="#run">run</a></b>(transaction_callback, store_names,
      mode, completed_event_handler)
    </div>

    <div class="description">
      Run an isolated database transaction.
    </div>
  </td>
</tr>
</tbody>
</table>



<div class="details">
  <a name="constructor"></a>

  <div class="sectionTitle">
    Class Detail
  </div>

  <div class="fixedFont">
    <b>ydn.db.core.Storage</b>(opt_dbname, opt_schema, opt_options)
  </div>


  <dl class="detailList">
    <dt class="heading">See:</dt>

    <dd>Super class constructor:  <a
            href="https://sites.google.com/a/yathit.com/ydn-dev/api-reference/ydn-db-con-storage.html">ydn.db.con.Storage</a></dd>
  </dl>
</div>




<div class="sectionTitle">
  Method Detail
</div>
<a name="clear"></a>


<div class="fixedFont">
  <span class="light">{!goog.async.Deferred}</span> <b>clear</b>(store_name, id)
</div>

<div class="description">
  Remove a specific entry from a store.
</div>

<dl class="detailList">
  <dt class="heading">Parameters:</dt>

  <dt><span class="light fixedFont">{string}</span> <b>store_name</b></dt>

  <dd>the store name.</dd>

  <dt><span class="light fixedFont">{string}</span> <b>id</b></dt>

  <dd>object key.</dd>
</dl>

<dl class="detailList">
  <dt class="heading">Returns:</dt>

  <dd><span class="light fixedFont">{!goog.async.Deferred}</span> if successfully clear, return <code>true</code> in the deferred function.</dd>
</dl>

<a name="clear1"></a>
<div class="fixedFont">
  <span class="light">{!goog.async.Deferred}</span> <b>clear</b>(store_name, ids)
</div>

<div class="description">
  Remove list of objects from a store.
</div>

<dl class="detailList">
  <dt class="heading">Parameters:</dt>

  <dt><span class="light fixedFont">{string}</span> <b>store_name</b></dt>

  <dd>store name.</dd>

  <dt><span class="light fixedFont">{Array}</span> <b>ids</b></dt>

  <dd>List of object keys to clear.</dd>
</dl>

<dl class="detailList">
  <dt class="heading">Returns:</dt>

  <dd><span class="light fixedFont">{!goog.async.Deferred}</span> if successfully clear, return <code>true</code> in the deferred function.</dd>
</dl>

<a name="clear2"></a>
<div class="fixedFont">
  <span class="light">{!goog.async.Deferred}</span> <b>clear</b>(key)
</div>

<div class="description">
  Remove a specific entry
</div>

<dl class="detailList">
  <dt class="heading">Parameters:</dt>

  <dt><span class="light fixedFont">{ydn.db.Key}</span> <b>key</b></dt>

  <dd>key to clear associated object.</dd>
</dl>

<dl class="detailList">
  <dt class="heading">Returns:</dt>

  <dd><span class="light fixedFont">{!goog.async.Deferred}</span> if successfully clear, return <code>true</code> in the deferred function.</dd>
</dl>

<a name="clear3"></a>
<div class="fixedFont">
  <span class="light">{!goog.async.Deferred}</span> <b>clear</b>(keys)
</div>

<div class="description">
  Clear list of objects. Objects are not necessarily in a single store. Transaction is atomic.
</div>

<dl class="detailList">
  <dt class="heading">Parameters:</dt>

  <dt><span class="light fixedFont">{!Array.&lt;!ydn.db.Key&gt;}</span> <b>keys</b></dt>

  <dd>keys to clear associated objects.</dd>
</dl>

<dl class="detailList">
  <dt class="heading">Returns:</dt>

  <dd><span class="light fixedFont">{!goog.async.Deferred}</span> if successfully clear, return <code>true</code> in the deferred function.</dd>
</dl>

<a name="clear4"></a>
<div class="fixedFont">
  <span class="light">{!goog.async.Deferred}</span> <b>clear</b>(store_name)
</div>

<div class="description">
  Clear all objects in the store.
</div>

<dl class="detailList">
  <dt class="heading">Parameters:</dt>

  <dt><span class="light fixedFont">{string}</span> <b>store_name</b></dt>

  <dd>store name.</dd>
</dl>

<dl class="detailList">
  <dt class="heading">Returns:</dt>

  <dd><span class="light fixedFont">{!goog.async.Deferred}</span> if successfully clear, return <code>true</code> in the deferred function.</dd>
</dl>

<a name="clear5"></a>
<div class="fixedFont">
  <span class="light">{!goog.async.Deferred}</span> <b>clear</b>()
</div>

<div class="description">
  Clear objects in the database.
</div>

<dl class="detailList">
  <dt class="heading">Returns:</dt>

  <dd><span class="light fixedFont">{!goog.async.Deferred}</span> if successfully clear, return <code>true</code> in the deferred function.</dd>
</dl>


<hr>

<a name="count"></a>


<div class="fixedFont">
  <span class="light">{!goog.async.Deferred}</span> <b>count</b>(opt_store_name)
</div>


<div class="description">
  Get number of items in a store or all stores.
</div>


<dl class="detailList">
  <dt class="heading">Parameters:</dt>

  <dt><span class="light fixedFont">{string=}</span> <b>opt_store_name</b></dt>

  <dd>store name, if not provided, count all entries in the database.</dd>
</dl>


<dl class="detailList">
  <dt class="heading">Returns:</dt>

  <dd><span class="light fixedFont">{!goog.async.Deferred.&lt;number&gt;}</span> return number of entries in deferred function.</dd>
</dl>

<hr>

<a name="get"></a>
<div class="fixedFont">
  <span class="light">{!goog.async.Deferred}</span> <b>get</b>(store_name, id)
</div>


<div class="description">
  Retrieve an object.
</div>


<dl class="detailList">
  <dt class="heading">Parameters:</dt>

  <dt><span class="light fixedFont">{string}</span> <b>store_name</b></dt>

  <dd>The name of store to retrive object from.</dd>

  <dt><span class="light fixedFont">{IDbKey}</span> <b>id</b></dt>

  <dd>Key of an object to be retrieved. It is the value of the object in <code>keyPath</code> or auto-generated
  <code>IDbKey</code> is either of <code>string</code>, <code>number</code>, <code>Date</code> or <code>Array.&lt;string&gt;</code>
  </dd>
</dl>

    <dl class="detailList">
  <dt class="heading">Returns:</dt>

  <dd><span class="light fixedFont">{!goog.async.Deferred}</span> return resulting object in deferred function. If not found, <code>undefined</code> is return.</dd>
</dl>


<a name="get1"></a>
<div class="fixedFont">
  <span class="light">{!goog.async.Deferred}</span> <b>get</b>(store_name, ids)
</div>


<div class="description">
  Retrieve objects.
</div>


<dl class="detailList">
  <dt class="heading">Parameters:</dt>

  <dt><span class="light fixedFont">{string}</span> <b>store_name</b></dt>

  <dd>The name of store to retrive object from.</dd>

  <dt><span class="light fixedFont">{Array}</span> <b>ids</b></dt>

  <dd>Retrieve list of object from given ids.</dd>
</dl>

<dl class="detailList">
  <dt class="heading">Returns:</dt>

  <dd><span class="light fixedFont">{!goog.async.Deferred}</span> return resulting objects as array list in deferred function. If not found, <code>undefined</code> is return.</dd>
</dl>

<a name="get2"></a>
<div class="fixedFont">
  <span class="light">{!goog.async.Deferred}</span> <b>get</b>(store_name)
</div>


<div class="description">
  Retrieve all objects in the store.
</div>


<dl class="detailList">
  <dt class="heading">Parameters:</dt>

  <dt><span class="light fixedFont">{string}</span> <b>store_name</b></dt>

  <dd>The name of store to retrieve objects from.</dd>

</dl>

<dl class="detailList">
  <dt class="heading">Returns:</dt>

  <dd><span class="light fixedFont">{!goog.async.Deferred}</span> return resulting objects array list in deferred function.</dd>
</dl>


<a name="get3"></a>
<div class="fixedFont">
  <span class="light">{!goog.async.Deferred}</span> <b>get</b>()
</div>


<div class="description">
  Retrieve all objects in the database.
</div>


<dl class="detailList">
  <dt class="heading">Returns:</dt>

  <dd><span class="light fixedFont">{!goog.async.Deferred}</span> return resulting objects array list in deferred function.</dd>
</dl>

<a name="get4"></a>
<div class="fixedFont">
  <span class="light">{!goog.async.Deferred}</span> <b>get</b>(key)
</div>


<div class="description">
  Retrieve an object as referred by the given key.
</div>


<dl class="detailList">
  <dt class="heading">Parameters:</dt>

  <dt><span class="light fixedFont">{ydn.db.Key}</span> <b>key</b></dt>

  <dd>The key of the object to retrieve.</dd>

</dl>

<dl class="detailList">
  <dt class="heading">Returns:</dt>

  <dd><span class="light fixedFont">{!goog.async.Deferred}</span> return resulting object in deferred function.</dd>
</dl>

<a name="get5"></a>
<div class="fixedFont">
  <span class="light">{!goog.async.Deferred}</span> <b>get</b>(keys)
</div>


<div class="description">
  Retrieve list of objects as referred by the given keys.
</div>


<dl class="detailList">
  <dt class="heading">Parameters:</dt>

  <dt><span class="light fixedFont">{!Array.&lt;!ydn.db.Key&gt;}</span> <b>keys</b></dt>

  <dd>The key of the object to retrieve.</dd>

</dl>

<dl class="detailList">
  <dt class="heading">Returns:</dt>

  <dd><span class="light fixedFont">{!goog.async.Deferred}</span> return resulting objects as array list in deferred function.</dd>
</dl>

<hr>
<a name="put"></a>
<div class="fixedFont">
  <span class="light">{!goog.async.Deferred}</span> <b>put</b>(store_name, value)
</div>
<div class="description">
  Put an object to the store.
</div>
<dl class="detailList">
  <dt class="heading">Parameters:</dt>
  <dt><span class="light fixedFont">{string}</span> <b>store_name</b></dt>
  <dd>the name of store to use.</dd>
  <dt><span class="light fixedFont">{!Object}</span> <b>value</b></dt>
  <dd>object to put.</dd>
</dl>

<a name="put1"></a>
<div class="fixedFont">
    <span class="light">{!goog.async.Deferred}</span> <b>put</b>(store_name, value, id)
</div>


<div class="description">
    Put an object to the store with given external key.
</div>


<dl class="detailList">
    <dt class="heading">Parameters:</dt>

    <dt><span class="light fixedFont">{string}</span> <b>store_name</b></dt>

    <dd>the name of store to use.</dd>

    <dt><span class="light fixedFont">{!Object}</span> <b>value</b></dt>

    <dd>object to put.</dd>

    <dt><span class="light fixedFont">{IDbKey}</span> <b>id</b></dt>

    <dd>object to put.</dd>
</dl>


<dl class="detailList">
    <dt class="heading">Throws:</dt>

    <dt><span class="light fixedFont">{ydn.error.ArgumentException}</span> <b>:</b></dt>

    <dd>The object store uses in-line keys or &lt;autoIncrement&gt; is true.</dd>

</dl>

<dl class="detailList">
  <dt class="heading">Returns:</dt>

  <dd><span class="light fixedFont">{!goog.async.Deferred}</span> return key in deferred function. </dd>
</dl>


<div class="fixedFont">
  <span class="light">{!goog.async.Deferred}</span> <b>put</b>(store_name, values)
</div>


<div class="description">
  Put list of object to the store.
</div>


<dl class="detailList">
  <dt class="heading">Parameters:</dt>

  <dt><span class="light fixedFont">{string}</span> <b>store_name</b></dt>

  <dd>the name of store to use.</dd>

  <dt><span class="light fixedFont">{!Array}</span> <b>values</b></dt>

  <dd>list of objects to put.</dd>
</dl>


<dl class="detailList">
  <dt class="heading">Returns:</dt>

  <dd><span class="light fixedFont">{!goog.async.Deferred}</span> return list of keys in deferred function. On error, an {@code Error} object is return as received from the mechanism.</dd>
</dl>

<div class="fixedFont">
    <span class="light">{!goog.async.Deferred}</span> <b>put</b>(store_name, values, ids)
</div>


<div class="description">
    Put list of object to the store.
</div>


<dl class="detailList">
    <dt class="heading">Parameters:</dt>

    <dt><span class="light fixedFont">{string}</span> <b>store_name</b></dt>

    <dd>the name of store to use.</dd>

    <dt><span class="light fixedFont">{!Array}</span> <b>values</b></dt>

    <dd>list of objects to put.</dd>

    <dt><span class="light fixedFont">{!Array.&lt;IDbKey&gt;}</span> <b>ids</b></dt>

    <dd>list of ids corresponding to objects.</dd>
</dl>


<dl class="detailList">
    <dt class="heading">Returns:</dt>

    <dd><span class="light fixedFont">{!goog.async.Deferred}</span> return list of keys in deferred function. </dd>
</dl>

<hr>
<a name="run"></a>

<div class="fixedFont">
  <b>run</b>(transaction_callback, store_names,
  mode, completed_event_handler)
</div>

<div class="description">
  Preform a isolated non-overlapping database transaction asynchronously. If invoke from base
  <code>ydn.db.core.Storage</code> instance, this create a new transaction immediately. Subsequents call
  from the <code>ydn.db.tr.Storage</code> create non-overlapping transaction.</div>

<dl class="detailList">
  <dt class="heading">Parameters:</dt>

  <dt><span class="light fixedFont">{!function(ydn.db.tr.IStorage: tdb)}</span> <b>transaction_callback</b></dt>

  <dd>Transaction in callback function. The callback is invoked with <code>ydn.db.tr.IStorage</code> instance.
    Use <code>tdb.getTx()</code> to get active transaction object, which could be either of  <code>IDBTransaction</code>,
    <code>SQLTransaction</code>, or <code>localStorage</code> depending on runtime environment.
    It returns <code>null</code> when transaction is no longer active.
    <br/>
    Use <code>tdb.run(...)</code> to create non-overlapping serial transaction run. The callback will
    be invoked when previous one is completed.
  </dd>

  <dt><span class="light fixedFont">{Array.&lt;string&gt;}</span>
    <b>store_names</b></dt>

  <dd>List of store name. If empty list, all stores are open.</dd>

  <dt><span class="light fixedFont">{string}</span> <b>mode</b></dt>

  <dd>Transaction mode: <code>readonly</code> (default) or <code>readwrite</code>.</dd>

  <dt><span class="light fixedFont">{function(string: type, *: event)}</span> <b>completed_event_handler</b></dt>

  <dd>Handle event for transaction <code>completed</code>, <code>error</code> or <code>abort</code> event type.
    If provided, handler will be called once and only once immediately after the transacting become
    inactive. </dd>

  <dt><span class="light fixedFont">{...}</span> <b>opt_var_args</b></dt>

  <dd>Optional variable arguments pass back to <code>transaction_callback</code> post-pending to argument <code>tx</code></dd>

</dl>
<pre>for (var i = 1; i &lt;= 3; i++) {
  console.log('Requesting to update player ' + i);
  db.run(function increaseHealth10(tdb, i) {
    tdb.get('player', i).success(function(p1) {
      p1.health += 10;
      tbd.put('player', p1).success(function(p1id) {
        console.log('Player ' + p1id + ' updated.');
      })
    })
  }, ['player'], 'readwrite', i)
}</pre>
